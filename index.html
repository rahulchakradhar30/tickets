<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>District-style Ticket — Generator (No QR)</title>
<style>
  :root{
    --bg1:#000;
    --bg2:#071428;
    --panel:#0b0b0d;
    --muted:#9aa3ad;
    --accent:#ff6b6b;
    --white:#ffffff;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    min-height:100vh;
    background: radial-gradient(1000px 600px at 10% 10%, #081220 0%, transparent 20%),
                radial-gradient(800px 500px at 90% 90%, #08121a 0%, transparent 20%),
                linear-gradient(180deg,var(--bg1),var(--bg2) 60%);
    color:var(--white);
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:28px;
  }

  .layout{
    width:100%;
    max-width:1100px;
    display:grid;
    grid-template-columns:1fr 480px;
    gap:26px;
  }

  .panel{
    background: linear-gradient(180deg,#07101a,#07111b);
    border-radius:12px;
    padding:18px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.6);
  }
  h2{ margin:0 0 6px; font-size:20px; color:#e9eef6; }
  p.hint{ color:var(--muted); margin:6px 0 12px; font-size:13px; }

  label{ display:block; font-size:13px; color:var(--muted); margin-top:12px; margin-bottom:6px; }
  input[type="text"], input[type="date"], input[type="time"], input[type="file"]{
    width:100%;
    padding:10px 12px;
    border-radius:8px;
    border:1px solid rgba(255,255,255,0.04);
    background:rgba(255,255,255,0.02);
    color:var(--white);
    font-size:14px;
  }
  .grid2{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
  .actions{ display:flex; gap:12px; margin-top:14px; }
  .btn{
    padding:12px 14px; border-radius:10px; border:none; font-weight:700; cursor:pointer; font-size:14px;
  }
  .btn.primary{ background: linear-gradient(90deg,var(--accent),#ee5a24); color:#fff; flex:1; }
  .btn.ghost{ background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--white); width:110px; }

  /* preview ticket */
  .preview-wrap{ display:flex; align-items:center; justify-content:center; }
  .ticket{
    width:420px; background:linear-gradient(180deg,#0a0a0b,#0b0b0d); border-radius:16px; padding:18px; box-shadow:0 18px 40px rgba(0,0,0,0.6);
    color:#fff; position:relative; overflow:hidden; font-size:14px;
  }

  /* top header (pattern area + logo) */
  .ticket .header{
    height:86px;
    background: linear-gradient(180deg,#14121a,#0b0b0d);
    border-radius:10px;
    display:flex;
    align-items:center;
    justify-content:center;
    margin:-18px -18px 12px -18px;
    position:relative;
  }
  .logo-img{ width:160px; height:auto; display:block; filter: drop-shadow(0 6px 18px rgba(0,0,0,0.6)); }

  .top{
    display:flex; gap:12px; align-items:center;
  }
  .poster{
    width:60px; height:86px; border-radius:6px; background:linear-gradient(180deg,#222,#111);
    overflow:hidden; flex:0 0 60px; display:flex; align-items:center; justify-content:center;
  }
  .poster img{ width:100%; height:100%; object-fit:cover; display:block; }

  .title{ font-weight:800; font-size:16px; color:#fff; }
  .meta{ color:var(--muted); font-size:12px; margin-top:4px; }

  .big-placeholder{
    width:220px; height:220px; background:#fff; border-radius:18px; display:block;
    margin:18px auto; box-shadow: 0 10px 20px rgba(0,0,0,0.4);
  }

  .ticket .info{ text-align:center; margin-top:6px; }
  .ticket .info .line{ font-size:12px; color:var(--muted); margin-top:8px; letter-spacing:1px; }
  .ticket .info .value{ font-weight:800; font-size:14px; margin-top:6px; }

  /* perforation and bottom */
  .perforation{
    height:28px;
    display:flex;
    align-items:center;
    justify-content:center;
    margin-top:14px;
    position:relative;
  }
  .perforation::before{
    content:"";
    width:70%;
    height:2px;
    border-top:2px dashed rgba(255,255,255,0.08);
    display:block;
  }
  .address{
    padding:18px 22px; text-align:center; color:#d2d2d2; font-size:14px; line-height:1.4;
  }
  .booking{ color:rgba(255,255,255,0.6); font-size:12px; text-align:center; margin-top:6px; }

  /* bottom branding */
  .bottom-bar{
    width:100%;
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-top:22px;
    gap:12px;
  }
  .bottom-logo{ width:140px; height:auto; opacity:0.95; filter: drop-shadow(0 6px 16px rgba(0,0,0,0.6)); }
  .hashtag{ font-weight:800; font-size:28px; color:#fff; letter-spacing:0.6px; }

  @media (max-width:920px){
    .layout{ grid-template-columns:1fr; }
    .preview-wrap{ margin-top:18px; justify-content:center; }
  }
</style>
</head>
<body>

<div class="layout">
  <!-- Left: form -->
  <div class="panel">
    <h2>District Ticket — Generator (no QR)</h2>
    <p class="hint">Upload poster (optional). Fill details. Generate preview and download ticket PNG. QR placeholder will be blank — paste QR manually using PicsArt.</p>

    <label>Movie Poster (optional)</label>
    <input id="posterFile" type="file" accept="image/*">

    <label>Movie Title</label>
    <input id="movieName" type="text" placeholder="Akhanda 2: Thaandavam">

    <div class="grid2">
      <div>
        <label>Movie Date</label>
        <input id="movieDate" type="date">
      </div>
      <div>
        <label>Movie Time</label>
        <input id="movieTime" type="time">
      </div>
    </div>

    <div class="grid2">
      <div>
        <label>Theatre</label>
        <input id="theatre" type="text" placeholder="V Mega Anand Cine Complex, National Highway 18, Kurnool">
      </div>
      <div>
        <label>Screen</label>
        <input id="screen" type="text" placeholder="Screen-1">
      </div>
    </div>

    <label>Seats (comma separated)</label>
    <input id="seats" type="text" placeholder="GOLD-B9">

    <div class="grid2" style="margin-top:12px;">
      <div>
        <label>Language / Format</label>
        <input id="lang" type="text" placeholder="Telugu | 2D">
      </div>
      <div>
        <label>Booking ID (optional)</label>
        <input id="booking" type="text" placeholder="Leave empty to auto-generate">
      </div>
    </div>

    <div class="actions">
      <button class="btn primary" onclick="generatePreview()">Generate Preview</button>
      <button class="btn ghost" onclick="resetAll()">Reset</button>
    </div>

    <p class="small" style="margin-top:12px;color:var(--muted)">After preview, click <strong>Download Ticket</strong> on the right to save the full PNG. Then paste QR using PicsArt into the white square placeholder.</p>
  </div>

  <!-- Right: preview -->
  <div class="preview-wrap">
    <div class="ticket" id="ticketPreview" role="presentation">
      <div class="header" id="headerArea">
        <!-- TOP compact logo (embedded SVG data URI - compact "district" with subtle glow) -->
        <img id="logoImg" class="logo-img" alt="district logo"
             src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="420" height="90" viewBox="0 0 420 90"><defs><filter id="g" x="-50%" y="-50%" width="200%" height="200%"><feGaussianBlur stdDeviation="2.5" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs><rect width="420" height="90" fill="none"/><text x="50%" y="60%" text-anchor="middle" font-family="Inter, Arial, sans-serif" font-weight="800" font-size="46" fill="%23ffffff" filter="url(%23g)">district</text></svg>' />
      </div>

      <div class="top">
        <div class="poster" id="posterPreview"><img id="posterImg" src="" alt="poster" style="display:none"></div>
        <div style="flex:1">
          <div class="title" id="pvTitle">Movie Title</div>
          <div class="meta" id="pvMeta">Telugu | 2D</div>
        </div>
        <div style="text-align:right">
          <div id="pvDate">Date</div>
          <div class="meta" id="pvTime">Time</div>
        </div>
      </div>

      <div class="big-placeholder" id="qrPlaceholder" aria-hidden="true">
        <!-- intentionally blank white box for manual QR placement -->
      </div>

      <div class="info">
        <div class="line">SCREEN</div>
        <div class="value" id="pvScreen">-</div>

        <div class="line" style="margin-top:10px">SEAT</div>
        <div class="value" id="pvSeats">-</div>

        <div class="line" style="margin-top:10px">THEATRE</div>
        <div class="value" id="pvTheatre">-</div>
      </div>

      <div class="perforation" aria-hidden="true"></div>

      <div class="address" id="pvAddress">Theatre address will appear here</div>

      <div class="booking" id="pvBooking">Booking ID: -</div>

      <div class="bottom-bar">
        <!-- BOTTOM full logo (embedded SVG data URI: district + BY ZOMATO) -->
        <img id="bottomLogo" class="bottom-logo" alt="district bottom logo"
          src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="520" height="120" viewBox="0 0 520 120"><rect width="100%" height="100%" fill="none"/><text x="10" y="46" font-family="Inter, Arial, sans-serif" font-weight="800" font-size="42" fill="%23ffffff">district</text><text x="12" y="86" font-family="Inter, Arial, sans-serif" font-weight="700" font-size="14" fill="%23ffffff">BY ZOMATO</text></svg>' />
        <div class="hashtag">#SeeYouThere</div>
      </div>

      <a id="downloadTicketBtn" class="download" href="#" style="display:block;margin-top:14px;text-decoration:none;color:#fff;background:linear-gradient(90deg,#2db04b,#178f2f);padding:10px;border-radius:8px;text-align:center;font-weight:800;" onclick="downloadTicket(event)">Download Ticket</a>
    </div>
  </div>
</div>

<script>
(function(){
  // elements
  const posterFile = document.getElementById('posterFile');
  const posterImg = document.getElementById('posterImg');
  const posterPreview = document.getElementById('posterPreview');

  const pvTitle = document.getElementById('pvTitle');
  const pvMeta = document.getElementById('pvMeta');
  const pvDate = document.getElementById('pvDate');
  const pvTime = document.getElementById('pvTime');
  const pvScreen = document.getElementById('pvScreen');
  const pvSeats = document.getElementById('pvSeats');
  const pvTheatre = document.getElementById('pvTheatre');
  const pvAddress = document.getElementById('pvAddress');
  const pvBooking = document.getElementById('pvBooking');

  // defaults
  function setDefaults(){
    const now = new Date();
    document.getElementById('movieDate').value = now.toISOString().split('T')[0];
    let hh = String(now.getHours()).padStart(2,'0');
    let mm = now.getMinutes() < 30 ? '00' : '30';
    document.getElementById('movieTime').value = hh + ':' + mm;
    document.getElementById('lang').value = 'Telugu | 2D';
  }
  setDefaults();

  // poster handling
  let posterDataUrl = null;
  posterFile.addEventListener('change', function(ev){
    const f = ev.target.files && ev.target.files[0];
    if(!f){ posterDataUrl = null; posterImg.style.display='none'; posterPreview.style.background=''; return; }
    const reader = new FileReader();
    reader.onload = function(e){
      posterDataUrl = e.target.result;
      posterImg.src = posterDataUrl;
      posterImg.style.display = 'block';
      posterPreview.style.background = '';
    };
    reader.readAsDataURL(f);
  });

  function genBooking(){
    return 'BK-' + Date.now().toString().slice(-10);
  }

  // generate preview (no QR generation)
  window.generatePreview = function(){
    const movieName = document.getElementById('movieName').value.trim() || 'Movie Title';
    const movieDate = document.getElementById('movieDate').value;
    const movieTime = document.getElementById('movieTime').value;
    const theatre = document.getElementById('theatre').value.trim() || 'V Mega Anand Cine Complex, National Highway 18, Kurnool';
    const screen = document.getElementById('screen').value.trim() || 'Screen-1';
    const seats = document.getElementById('seats').value.trim() || 'GOLD-B9';
    const lang = document.getElementById('lang').value.trim() || 'Telugu | 2D';
    const booking = document.getElementById('booking').value.trim() || genBooking();

    pvTitle.textContent = movieName;
    pvMeta.textContent = lang;
    try{
      const dObj = new Date(movieDate + 'T' + movieTime);
      pvDate.textContent = dObj.toLocaleDateString(undefined,{weekday:'short', day:'numeric', month:'short'});
      pvTime.textContent = new Date('1970-01-01T' + movieTime).toLocaleTimeString([], {hour:'numeric', minute:'2-digit'});
    }catch(e){
      pvDate.textContent = movieDate || 'Date';
      pvTime.textContent = movieTime || 'Time';
    }
    pvScreen.textContent = screen.toUpperCase();
    pvSeats.textContent = seats.toUpperCase();
    pvTheatre.textContent = theatre;
    pvAddress.textContent = theatre;
    pvBooking.textContent = 'Booking ID: ' + booking;

    // poster preview fallback
    if(posterDataUrl){
      posterImg.src = posterDataUrl;
      posterImg.style.display = 'block';
      posterPreview.style.background = '';
    } else {
      posterImg.style.display = 'none';
      posterPreview.style.background = 'linear-gradient(180deg,#2a2a2a,#111)';
    }
  };

  // reset
  window.resetAll = function(){
    document.getElementById('movieName').value = '';
    document.getElementById('theatre').value = '';
    document.getElementById('screen').value = '';
    document.getElementById('seats').value = '';
    document.getElementById('booking').value = '';
    posterFile.value = '';
    posterImg.src = '';
    posterImg.style.display = 'none';
    posterPreview.style.background = '';
    setDefaults();
    pvTitle.textContent = 'Movie Title';
    pvMeta.textContent = 'Telugu | 2D';
    pvDate.textContent = 'Date';
    pvTime.textContent = 'Time';
    pvScreen.textContent = '-';
    pvSeats.textContent = '-';
    pvTheatre.textContent = '-';
    pvAddress.textContent = 'Theatre address will appear here';
    pvBooking.textContent = 'Booking ID: -';
  };

  // download full ticket PNG (no QR inside — only white placeholder)
  window.downloadTicket = function(ev){
    ev && ev.preventDefault && ev.preventDefault();

    // create offscreen canvas
    const W = 1000, H = 1600;
    const off = document.createElement('canvas');
    off.width = W; off.height = H;
    const ctx = off.getContext('2d');

    // background
    ctx.fillStyle = '#060609';
    ctx.fillRect(0,0,W,H);

    // inner card
    const pad = 64;
    ctx.fillStyle = '#0f1113';
    roundRect(ctx, pad/2, pad/2, W - pad, H - pad, 32, true, false);

    // header pattern (top) — draw darker rectangle
    const headerH = 160;
    ctx.fillStyle = '#14121a';
    roundRect(ctx, pad/2 + 8, pad/2 + 8, W - pad - 16, headerH, 20, true, false);

    // draw TOP embedded logo (embedded SVG image URI)
    const topLogo = new Image();
    topLogo.onload = function(){
      const logoW = 420;
      const logoH = Math.round(topLogo.height/topLogo.width*logoW);
      ctx.drawImage(topLogo, (W - logoW)/2, pad/2 + 24, logoW, logoH);
      // continue drawing
      drawMain();
    };
    topLogo.onerror = function(){
      // fallback text
      ctx.fillStyle = '#fff';
      ctx.font = 'bold 48px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('district', W/2, pad/2 + 80);
      drawMain();
    };
    // compact top SVG (must match the one in the page)
    topLogo.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="420" height="90" viewBox="0 0 420 90"><defs><filter id="g" x="-50%" y="-50%" width="200%" height="200%"><feGaussianBlur stdDeviation="2.5" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs><rect width="420" height="90" fill="none"/><text x="50%" y="60%" text-anchor="middle" font-family=\'Inter, Arial, sans-serif\' font-weight="800" font-size="46" fill=\'%23ffffff\' filter="url(%23g)">district</text></svg>';

    function drawMain(){
      // poster area
      const posterW = 260, posterH = 380;
      const px = pad + 40, py = pad + headerH + 40;
      roundRect(ctx, px-8, py-8, posterW + 16, posterH + 16, 12, true, false); // background

      if(posterDataUrl){
        const img = new Image();
        img.onload = function(){
          const ratio = Math.max(posterW / img.width, posterH / img.height);
          const sw = posterW / ratio, sh = posterH / ratio;
          const sx = (img.width - sw) / 2, sy = (img.height - sh) / 2;
          ctx.drawImage(img, sx, sy, sw, sh, px, py, posterW, posterH);
          drawRightAndPlaceholder();
        };
        img.onerror = function(){ // if poster fails, draw placeholder
          ctx.fillStyle = '#222';
          roundRect(ctx, px, py, posterW, posterH, 10, true, false);
          drawRightAndPlaceholder();
        };
        img.src = posterDataUrl;
      } else {
        // placeholder
        const g = ctx.createLinearGradient(px,py,px+posterW,py+posterH);
        g.addColorStop(0,'#2a2a2a'); g.addColorStop(1,'#111');
        ctx.fillStyle = g; roundRect(ctx, px, py, posterW, posterH, 10, true, false);
        ctx.fillStyle = '#777';
        ctx.font = 'bold 22px Arial'; ctx.fillText('POSTER', px + 24, py + 40);
        drawRightAndPlaceholder();
      }
    }

    function drawRightAndPlaceholder(){
      const rx = pad + 320;
      const rw = W - rx - pad;
      // title
      ctx.fillStyle = '#fff';
      ctx.font = 'bold 44px Arial';
      wrapText(ctx, pvTitle.textContent, rx, pad + 200, rw - 40, 46);

      // meta
      ctx.fillStyle = '#bdbdbd';
      ctx.font = '20px Arial';
      ctx.fillText(pvMeta.textContent, rx, pad + 320);

      // date/time
      ctx.fillStyle = '#fff';
      ctx.font = '28px Arial';
      ctx.fillText(pvDate.textContent + '   |   ' + pvTime.textContent, rx, pad + 360);

      // big white QR placeholder centered
      const qsize = 420;
      const qx = (W - qsize) / 2;
      const qy = pad + 480;
      ctx.fillStyle = '#ffffff';
      roundRect(ctx, qx, qy, qsize, qsize, 34, true, false);

      // screen & seat under placeholder
      ctx.fillStyle = '#bdbdbd'; ctx.font = '18px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('SCREEN', W/2, qy + qsize + 60);
      ctx.fillStyle = '#fff'; ctx.font = '22px Arial';
      ctx.fillText(pvScreen.textContent, W/2, qy + qsize + 100);

      ctx.fillStyle = '#bdbdbd'; ctx.font = '18px Arial';
      ctx.fillText('SEAT', W/2, qy + qsize + 150);
      ctx.fillStyle = '#fff'; ctx.font = '22px Arial';
      ctx.fillText(pvSeats.textContent, W/2, qy + qsize + 190);

      // perforation dashed line
      const perY = qy + qsize + 240;
      ctx.strokeStyle = 'rgba(255,255,255,0.08)';
      ctx.lineWidth = 2;
      dashedLine(ctx, pad + 30, perY, W - pad - 30, perY, 14, 12);

      // address
      ctx.fillStyle = '#d6d6d6'; ctx.font = '18px Arial';
      wrapText(ctx, pvAddress.textContent, pad + 40, perY + 48, W - 2*(pad+40), 26);

      // booking id
      ctx.fillStyle = 'rgba(255,255,255,0.6)'; ctx.font = '16px Arial';
      ctx.textAlign = 'center';
      ctx.fillText(pvBooking.textContent, W/2, H - pad - 160);

      // bottom logo + hashtag (draw embedded bottom logo)
      const bottomLogo = new Image();
      bottomLogo.onload = function(){
        const lw = 220, lh = Math.round(bottomLogo.height/bottomLogo.width*lw);
        ctx.drawImage(bottomLogo, pad + 30, H - pad - lh - 20, lw, lh);
        // hashtag
        ctx.font = 'bold 42px Arial'; ctx.fillStyle = '#fff';
        ctx.textAlign = 'right';
        ctx.fillText('#SeeYouThere', W - pad - 30, H - pad - 40);
        // save
        finish();
      };
      bottomLogo.onerror = function(){
        // fallback text logo
        ctx.font = 'bold 28px Arial'; ctx.fillStyle = '#fff';
        ctx.textAlign = 'left';
        ctx.fillText('district', pad + 30, H - pad - 40);
        ctx.font = 'bold 42px Arial'; ctx.fillStyle = '#fff';
        ctx.textAlign = 'right';
        ctx.fillText('#SeeYouThere', W - pad - 30, H - pad - 40);
        finish();
      };
      bottomLogo.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="520" height="120" viewBox="0 0 520 120"><rect width="100%" height="100%" fill="none"/><text x="10" y="46" font-family=\'Inter, Arial, sans-serif\' font-weight="800" font-size="42" fill=\'%23ffffff\'>district</text><text x="12" y="86" font-family=\'Inter, Arial, sans-serif\' font-weight="700" font-size="14" fill=\'%23ffffff\'>BY ZOMATO</text></svg>';
    }

    function finish(){
      // trigger download
      const data = off.toDataURL('image/png');
      const a = document.createElement('a');
      a.href = data;
      a.download = (pvTitle.textContent || 'ticket') + '-ticket.png';
      a.click();
    }

    // helpers
    function roundRect(ctx,x,y,w,h,r,fill,stroke){
      if(typeof r==='undefined') r=6;
      ctx.beginPath();
      ctx.moveTo(x+r,y);
      ctx.arcTo(x+w,y,x+w,y+h,r);
      ctx.arcTo(x+w,y+h,x,y+h,r);
      ctx.arcTo(x,y+h,x,y,r);
      ctx.arcTo(x,y,x+w,y,r);
      ctx.closePath();
      if(fill) ctx.fill();
      if(stroke) ctx.stroke();
    }
    function wrapText(ctx, text, x, y, maxWidth, lineHeight){
      ctx.textAlign = 'left';
      const words = text.split(' ');
      let line = '';
      for(let n=0;n<words.length;n++){
        const testLine = line + words[n] + ' ';
        const metrics = ctx.measureText(testLine);
        const testWidth = metrics.width;
        if(testWidth > maxWidth && n>0){
          ctx.fillText(line, x, y);
          line = words[n] + ' ';
          y += lineHeight;
        } else {
          line = testLine;
        }
      }
      ctx.fillText(line, x, y);
    }
    function dashedLine(ctx, x1, y1, x2, y2, dash, gap){
      ctx.beginPath();
      let x = x1, y = y1;
      const dx = x2 - x1, dy = y2 - y1;
      const dist = Math.sqrt(dx*dx + dy*dy);
      const steps = Math.floor(dist / (dash + gap));
      const vx = dx / dist * (dash + gap);
      const vy = dy / dist * (dash + gap);
      for(let i=0;i<steps;i++){
        ctx.moveTo(x + i*vx, y + i*vy);
        ctx.lineTo(x + i*vx + (dx/dist)*dash, y + i*vy + (dy/dist)*dash);
      }
      ctx.stroke();
    }
  };

})();
</script>

</body>
</html>
